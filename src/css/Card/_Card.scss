//
//  MIT License
//
//  Copyright (c) 2021 GrowStocks
//
//  Permission is hereby granted, free of charge, to any person obtaining a copy
//  of this software and associated documentation files (the "Software"), to deal
//  in the Software without restriction, including without limitation the rights
//  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
//  copies of the Software, and to permit persons to whom the Software is
//  furnished to do so, subject to the following conditions:
//
//  The above copyright notice and this permission notice shall be included in all
//  copies or substantial portions of the Software.
//
//  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
//  SOFTWARE.
//

@use '../mixins';
@use '../Typography' as typography;

@mixin base(
    $padding,
    $border-radius,
    $margin-bottom
) {
    width: 100%;
    height: auto;
    padding: $padding;
    border-radius: $border-radius;
    margin-bottom: $margin-bottom;

    p {
        @include typography.generate(body-14);
        text-align: justify;
    }
}

@mixin render(
    $type: default,
    $padding: 10px,
    $border-radius: 0.3rem,
    $margin-bottom: 0,
    $fill: var(--primary-light),
    $ink: var(--on-primary),
    $icon-ink: var(--on-primary),
    $scaling: 1.03,
    $shape: default,
    $shape-exceptions: (),
    $clip-size: 0.7em,
    $custom-clip: ()
) {
    @if $type == default {
        .card {
            $shape-border-radius: () !default;
            $shape-padding: () !default;

            @if $shape == round {
                $shape-border-radius: $border-radius;
                $shape-padding: $padding;
            } @else if $shape == block {
                $shape-border-radius: 0;
                $shape-padding: $padding;
            } @else if $shape == clipped {
                $shape-border-radius: 0;
                $shape-padding: $padding;
                clip-path:
                    polygon(
                        0% $clip-size,
                        $clip-size 0%,
                        calc(100% - #{$clip-size}) 0%,
                        100% $clip-size,
                        100% calc(100% - #{$clip-size}),
                        calc(100% - #{$clip-size}) 100%,
                        $clip-size 100%,
                        0% calc(100% - #{$clip-size})
                    );
            } @else {
                $shape-border-radius: $border-radius;
                $shape-padding: $padding;
            }

            @include base($shape-padding, $shape-border-radius, $margin-bottom);
            @include fill($fill);
            @include ink($ink);

            .card__big-text {
                font-size: typography.px-to-rem(24px);
            }

            .card__small-text {
                font-size: typography.px-to-rem(12px);
            }

            &.stable {
                background-color: var(--success) !important;
            }

            &.semi-stable {
                background-color: var(--warning) !important;
                color: var(--on-warning) !important;
            }

            &.unstable {
                background-color: var(--error) !important;
            }

            &.undefined {
                background-color: var(--undefined) !important;
            }

            @at-root #{&}--on-surface {

                @include base(5px, $border-radius, 10px);

                background-color: var(--clear) !important;
            }
        }
    } @else if $type == x {
        .card--x {

            //@include mixins.shape($shape, 0, $border-radius, $clip-size);

            height: 110px;
            width: 100%;
            overflow: hidden;

            display: grid;
            grid-template-columns: 110px auto;

            @include typography.generate(body-12);
            @include mixins.prefix(transition, all 0.1s ease);

            &:hover,
            &:focus,
            &:focus-within {
                transform: scale($scaling);
            }

            .card--x__img {
                width: 110px;
                height: 110px;
                //border-radius: 5px 0 0 5px;

                overflow: hidden;

                img {
                    width: 110px;
                    height: 110px;
                    object-fit: cover;
                }
            }

            .card--x__container {
                width: 100%;
                padding: 10px;
                overflow: hidden !important;
                word-break: break-word;
                //border-radius: 0 5px 5px 0;

                @include fill(var(--primary-light));

                @include mixins.rainbow-factory();

                @media (min-width: 850px) {
                    padding: 10px;
                }

                .wrap--text {
                    margin-bottom: 7px;

                    .card--x__text {
                        position: relative;
                        color: inherit;
                        display: -webkit-box;
                        -webkit-line-clamp: 2;
                        -webkit-box-orient: vertical;
                        text-overflow: ellipsis;
                        overflow: hidden;
                        word-break: break-all;

                        &::before,
                        &::after {
                            content: '"';
                        }
                    }
                }

                h2 {
                    font-size: typography.px-to-rem(18px);
                    color: inherit;
                }

                .card--x__icons--wrap {
                    display: block;
                    width: 100%;
                    max-width: 200px;
                    margin-top: 7px;

                    a {
                        margin: 0 7px 0 0;
                        font-size: 24px;
                        color: $icon-ink;

                        @include mixins.prefix(transition, all 0.1s linear);

                        &:hover {
                            opacity: 0.5;
                        }
                    }
                }

                .card--x__action {
                    //
                }
            }
        }
    } @else if $type == y {
        .card--y {

            //@include mixins.shape($shape, 0, $border-radius, $clip-size);

            display: flex;
            flex-direction: column;
            overflow: hidden;
            width: 100%;
            margin: 0;

            @include fill(var(--primary-light));

            @include mixins.prefix(transition, all 0.1s ease!important);

            &:hover,
            &:focus,
            &:focus-within {
                transform: scale($scaling);
            }

            .card--y__img {
                //border-radius: 5px 5px 0 0;
                width: 100%;
                height: 120px !important;
                overflow-y: hidden;

                img {
                    //border-radius: 5px 5px 0 0;
                    width: 100%;
                    height: auto !important;
                }
            }

            .card--y__info {
                padding: $padding;

                .card--y__info__title {
                    font-size: typography.px-to-rem(20px);
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .card--y__info__subtitle {
                    font-size: typography.px-to-rem(14px);

                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .card--y__action {
                    color: var(--secondary);
                    background-color: var(--transparent);
                    padding: 0;
                    border: none;
                    border-radius: 5px;
                    font-weight: 700;
                    margin-top: 7px;

                    @include mixins.prefix(transition, all 0.1s ease!important);

                    &:hover {
                        color: var(--secondary-dark);
                        cursor: pointer;
                    }
                }

            }

            .card--y__footer {
                //
            }
        }
    }
}

// @API
@mixin fill($fill-value) {
    background-color: $fill-value;
}

@mixin ink($ink-value) {
    color: $ink-value;
}

@mixin icon-ink($icon-ink-value) {
    color: $icon-ink-value;
}

@mixin border($border-style, $border-radius) {
    border: $border-style;
    border-radius: $border-radius;
}

@mixin shape($clip-path) {
    clip-path: $clip-path;
}
