//
// Copyright (c) 2021 GrowStocks
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in all
// copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
// SOFTWARE.
//

@use 'sass:map';
@use '../mixins';
@use '../Typography' as typography;

@use '../Core';

@mixin base(
    $component-name: 'button',
    $base-padding: undefined,

    $base-fill: undefined,
    $base-ink: undefined,

    $base-options-fill: undefined,

    $base-font-size: undefined,
    $base-font-weight: undefined,

    $base-icon-size: undefined,
    $base-icon-ink: undefined,

    $base-shape: default,
    $base-shape-exceptions: (),

    $base-border: none,
    $base-border-radius: undefined,
    $base-clip-size: undefined,
    $base-custom-clip: (),

    $base-width: max-content,

    $base-spacer-ink: var(--surface),

    $base-type: (
        default: true
    )
) {
    #{$component-name}__container {
        height: max-content;
        position: relative;
        overflow: hidden;

        @include Core.shape($base-shape, $base-border-radius, $base-clip-size, $base-shape-exceptions,$base-custom-clip);

        .item__status__sym {
            display: inline !important;
            position: relative !important;
            top: 2px !important;
            right: 0 !important;
            font-size: 16px !important;
            font-weight: 400 !important;
        }

        .chip__options__trigger,
        .chip__modal__trigger {
            display: block;
            position: absolute;

            background-color: var(--transparent);
            color: $base-icon-ink;
            border: none;

            width: 32px;
            height: 32px;

            float: right;
            padding: 0;

            top: 4px;
            right: 7px;

            &:hover {
                cursor: pointer;
            }
        }

        #{$component-name} {
            width: 100%;
            display: grid;
            grid-template-columns: 42px 1fr 27px;
            padding: $base-padding;
            background-color: var(--primary-light);

            &::after {
                content: "";
                clear: both;
                display: table;
            }

            .chip__sprite {
                $sprite-display: inline;
                $sprite-size: 32px;
                $sprite-margin: 3px 10px 7px 2px;
                $sprite-float: left;

                img {
                    display: $sprite-display;
                    width: $sprite-size;
                    height: $sprite-size;
                    margin: $sprite-margin;
                    float: $sprite-float;
                }
            }

            $text-display: inline;

            .wrap--text {
                display: $text-display;
                width: 100% !important;
            }

            $title-font-size: typography.px-to-rem(20px);
            $subtitle-font-size: typography.px-to-rem(14px);

            h2 {
                font-size: $title-font-size;
                padding: 0 !important;
                display: $text-display;
            }

            .chip__info {
                display: block;

                p {
                    font-size: $subtitle-font-size;
                    padding: 0 !important;
                    display: $text-display;
                }
            }

            a {
                display: $text-display;
            }

            p {
                font-size: $subtitle-font-size;
                width: 100% !important;
                word-break: break-all;
                display: -webkit-box;
                -webkit-line-clamp: 2;
                -webkit-box-orient: vertical;
                text-overflow: ellipsis;
                overflow: hidden;
            }

            .chip__arrow {
                width: 12px !important;
                height: auto !important;
                top: 2px;
                margin: 0 2px 0 1px !important;
            }

            .chip__spacer {
                margin: 0;
                font-weight: 700;
                color: $base-spacer-ink;
                font-size: $subtitle-font-size!important;
            }
        }

        .chip__options {
            display: none;
            border: none;
            width: 100%;
            padding: 5px 10px;

            background-color: $base-options-fill;

            .chip__options__button {
                display: inline-block;
                border: none;
                font-size: typography.px-to-rem(13px) !important;

                @include mixins.prefix(transition, all 0.1s linear);

                &:hover {
                    cursor: pointer;
                    color: var(--secondary);
                }
            }

            .chip__options__spacer {
                color: $base-spacer-ink;
                font-size: typography.px-to-rem(13px) !important;
                font-weight: 700;
            }
        }

        .close {
            content: "close" !important;
        }

        .chip__footer {
            $border-radius: 0 0 0.3rem 0.3rem;
            $font-size: 12px;
            $font-weight: 700;

            width: 100%;
            padding: 5px 10px 4px 10px !important;
            border-radius: $border-radius;
            font-size: $font-size !important;
            font-weight: $font-weight !important;
            color: #fff !important;

            .chip__footer__spacer {
                font-size: inherit;
                color: inherit;
            }

            &.stable {
                background-color: var(--success);
            }

            &.semi-stable {
                background-color: var(--warning);

                p {
                    color: var(--on-secondary);
                }
            }

            &.unstable {
                background-color: var(--error);
            }

            &.undefined {
                background-color: var(--undefined);
            }

            @include mixins.rainbow-factory();

        }
    }
}

@mixin render(
    $fill: var(--primary-light),
    $options-fill: var(--primary--variant-dark),
    $ink: var(--on-primary),
    $icon-ink: var(--on-primary),
    $spacer-ink: var(--surface),
    $border: none,
    $border-radius: 0.3rem,
    $padding: 10px,
    $shape: default,
    $clip-size: 0.5rem,
    $shape-exceptions: ()
) {

    // .chip
    @include base(
        $component-name: '.chip',
        $base-fill: $fill,
        $base-options-fill: $options-fill,
        $base-ink: $ink,
        $base-spacer-ink: $spacer-ink,
        $base-border: $border,
        $base-border-radius: $border-radius,
        $base-padding: $padding,
        $base-shape: $shape,
        $base-clip-size: $clip-size,
        $base-shape-exceptions: $shape-exceptions
    );

    // LEGACY
    .wrap--market {
        .chip__options__button {
            display: inline-block;
            border: none;
            font-size: typography.px-to-rem(13px) !important;
            margin-right: 0 !important;

            &:hover {
                cursor: pointer;
            }
        }

        .chip {
            img {
                margin-bottom: 20px;
            }
        }
    }
}
